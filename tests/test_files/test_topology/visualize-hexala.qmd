---
title: Hexala topology
format:
  html:
    code-folding: true
mermaid-format: svg
execute:
  warning: false
  echo: true
---

# Hexala


```{python}
from kimmdy.parsing import read_topol
from kimmdy.topology.topology import Topology
from pathlib import Path
from kimmdy.misc_helper import top_to_graph
```

```{python}
hexala_top = read_topol(Path('hexala.top'))
hexala_break_29_35 = read_topol(Path("hexala_break29-35.top"))
hexala_move_34_29 = read_topol(Path("hexala_move34-29.top"))
ffdir = Path("../assets/amber99sb-star-ildnp.ff")
ffpatch = Path('amber99sb_patches.xml')
top = Topology(hexala_top, ffdir, ffpatch)
top_break_29_25 = Topology(hexala_break_29_35, ffdir, ffpatch)
ala_r = read_topol(Path("AlaCa_R.top"))
top_ala_r = Topology(ala_r, ffdir, ffpatch)

ls = top_to_graph(top, overlap='true') 
with open("hexala-top.dot", "w") as f:
  f.writelines(ls)

ls = top_to_graph(top_break_29_25, overlap='false') 
with open("hexala-break.dot", "w") as f:
  f.writelines(ls)

ls = top_to_graph(top_ala_r, overlap='false')
with open("ala-r.dot", "w") as f:
  f.writelines(ls)
```

## Natural

```{dot}
//| echo: false
//| label: fig-hexala
//| fig-cap: "A diagram of the hexala topology"
//| file: hexala-top.dot
```

- break: 29-35
- move: 34-29

```{dot}
//| echo: false
//| label: fig-hexala-break
//| fig-cap: "A diagram of the hexala topology"
//| file: hexala-break.dot
```

## Move

### Modified

```{python}
top_move_34_29 = Topology(hexala_move_34_29, ffdir, ffpatch)
ls = top_to_graph(top_move_34_29, overlap='false')
with open("hexala-move.dot", "w") as f:
  f.writelines(ls)
```

```{dot}
//| echo: false
//| label: fig-hexala-move
//| fig-cap: "A diagram of the hexala topology"
//| file: hexala-move.dot
```

### Modified by topology module

```{python}
top.break_bond(("29", "35"))
top.break_bond(("31", "34"))
top.bind_bond(("34", "29"))
```

```{python}
ls = top_to_graph(top, overlap='false')
with open("hexala-move-top.dot", "w") as f:
  f.writelines(ls)
```

```{dot}
//| echo: false
//| label: fig-hexala-move-top
//| fig-cap: "A diagram of the hexala topology modified"
//| file: hexala-move-top.dot
```

## Ala R

```{dot}
//| echo: false
//| label: fig-ala-r
//| fig-cap: "A diagram of the broken ala topology"
//| file: ala-r.dot
//| column: page
```



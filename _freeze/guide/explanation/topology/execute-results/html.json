{
  "hash": "191a987ff01596d37b5578670d3df058",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Visualize Topologies\nmermaid-format: svg\n---\n\n## Capped Alanine with a radical\n\n::: {#a785cc2c .cell execution_count=1}\n``` {.python .cell-code}\nfrom kimmdy.parsing import read_top\nfrom kimmdy.topology.topology import Topology\nfrom pathlib import Path\nfrom kimmdy.tools import write_top_as_dot\n```\n:::\n\n\n::: {#3370e1d9 .cell execution_count=2}\n``` {.python .cell-code}\nala_top = read_top(Path('../../tests/test_files/test_topology/Ala_R_prm.top'), use_gmx_dir=False)\ntop = Topology(ala_top)\n\nwrite_top_as_dot(top, \"ala-top.dot\")\n```\n:::\n\n\n```{dot}\n//| echo: false\n//| label: fig-ala\n//| fig-cap: \"A diagram of the Ala topology\"\n//| file: ala-top.dot\n```\n\n\n## Multiple molecules\n\n::: {#bd4f91fb .cell execution_count=3}\n``` {.python .cell-code}\nurea_dict = read_top(Path('../../tests/test_files/test_topology/urea.top'), use_gmx_dir=False)\nurea = Topology(urea_dict)\n\nwrite_top_as_dot(urea, \"urea-top.dot\")\n```\n:::\n\n\n```{dot}\n//| echo: false\n//| label: fig-ala\n//| fig-cap: \"Topology of one molecule of urea\"\n//| file: urea-top.dot\n```\n\n\n\nWhen we want to run reactions within molecules that are either\nseparate moleculetypes or multiples of the same moleculetype,\nKIMMDY can combine those into a single moleculetype and\nmake multiples explicit.\n\ni.e. if we have a topology with two molecules of urea\ndefined as:\n\n```ini\n[ system ]\nUrea in Water\n\n[ molecules ]\n;molecule name   nr.\nUrea             2\nSOL              1000\n```\n\n::: {#82156790 .cell execution_count=4}\n``` {.python .cell-code}\nurea_dict = read_top(Path('../../tests/test_files/test_topology/urea-times-2.top'), use_gmx_dir=False)\nurea = Topology(urea_dict)\nwrite_top_as_dot(urea, \"urea-2-top.dot\")\n```\n:::\n\n\nWe end up with\n\n\n```{dot}\n//| echo: false\n//| label: fig-ala\n//| fig-cap: \"A diagram of the two urea molecules topology\"\n//| file: urea-2-top.dot\n```\n\n\nThis way, explicit atom numbers match up with the atom numbers\nin the coordinate file (or rather, line numbers - 2, since the\nnumbers in the actual `atomnr` column can overflow due to the fixed-width file format).\n\n::: {#41f6d832 .cell execution_count=5}\n``` {.python .cell-code}\nurea_dict = read_top(Path('../../tests/test_files/test_topology/urea-times-2.top'), use_gmx_dir=False)\nurea = Topology(urea_dict)\nurea\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\nTopology with the following molecules: \nReactive: 1\nSOL: 1000\n\nWith Moleculetype Reactive with:\n16 atoms,\n14 bonds,\n0 angles,\n0 pairs,\n16 proper dihedrals\n6 improper dihedrals\n6 position restraints\n4 dihedral restraints\n\nForceField parameters with\n0 atomtypes,\n0 bondtypes,\n0 angletypes,\n0 proper dihedraltypes\n0 improper dihedraltypes\n0 residuetypes\n```\n:::\n:::\n\n\n",
    "supporting": [
      "topology_files"
    ],
    "filters": [],
    "includes": {}
  }
}